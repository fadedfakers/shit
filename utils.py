import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
import os
from io import StringIO
from sklearn.preprocessing import MinMaxScaler

# --- CONFIGURATION ---
RESULTS_DIR = "results"
FIGURES_DIR = os.path.join(RESULTS_DIR, "figures")

# Ensure directories exist
os.makedirs(FIGURES_DIR, exist_ok=True)

# --- PLOTTING STYLE CONFIGURATION ---
def set_plot_style():
    plt.style.use('seaborn-v0_8-whitegrid')
    sns.set_context("paper", font_scale=1.4)
    
    # 字体设置
    plt.rcParams['font.sans-serif'] = ['Arial', 'Helvetica', 'DejaVu Sans', 'SimHei']
    plt.rcParams['axes.unicode_minus'] = False
    plt.rcParams['figure.dpi'] = 300
    
    # [CRITICAL FIX] 禁用全局 tight 布局，防止因 NaN 数据导致渲染崩溃
    # plt.rcParams['savefig.bbox'] = 'tight'  <-- 注释掉这一行
    
    # 颜色盘
    global PALETTE
    PALETTE = sns.color_palette("viridis", 10)

set_plot_style()

# --- DATA STORAGE (保持不变) ---
RAW_CSV_DATA = """Country,Year,Top500超级计算机数量,GPU集群规模_百万个,数据中心总算力,AI芯片保有量_百万个,5G覆盖率,互联网带宽,数据中心数量,互联网普及率,AI研究人员数量_千人,AI人才净流入_千人,顶尖AI学者数量_千人,STEM毕业生数量_百万,AI论文数量_千篇,高校AI实验室数量,政府AI投资_亿美元,企业AI研发支出_亿美元,风险投资_亿美元,AI论文引用量_千次,AI专利申请数量_千件,AI市场规模_亿美元,AI企业数量,AI独角兽企业数量,大模型数量,产业市场规模_亿美元,AI企业税收减免比例,补贴金额_亿美元,政策数量,补贴力度,监管框架完善程度,GDP_亿美元,GDP增长率,外汇储备_十亿美元,人口_百万,劳动年龄人口比例,高等教育毛入学率,全球创新指数排名,研发人员密度_每百万人,FDI流入_十亿美元
美国,2016,171,0.3,2600,2.0,0,0.3,2600,88,150.0,50.0,10.0,0.57,12,200,5.0,250,20.0,15,5.0,10.0,1000,50,5,10.0,20,1.0,1,5,70,18707,1.7,404,323,66.1,88.8,4,4312,472
美国,2017,169,0.5,2800,3.0,0,0.5,2800,89,160.0,55.0,11.0,0.6,13,220,6.0,300,25.0,16,6.0,15.0,1500,100,10,15.0,20,1.5,5,5,72,19543,2.3,449,325,65.8,88.2,4,4419,343
美国,2018,143,1.0,3000,5.0,0,1.0,3000,90,170.0,60.0,12.0,0.62,14,240,8.0,350,30.0,17,7.0,20.0,2000,150,15,20.0,20,2.0,10,6,75,20580,2.9,449,327,65.5,88.3,6,4527,258
美国,2019,140,2.0,3200,10.0,10,2.0,3200,91,180.0,65.0,13.0,0.65,15,260,10.0,400,40.0,18,8.0,30.0,2500,200,20,30.0,20,3.0,20,6,78,21433,2.3,449,329,65.3,88.3,3,4636,305
美国,2020,144,5.0,3400,25.0,40,5.0,3400,92,200.0,70.0,14.0,0.68,16,280,15.0,450,50.0,20,10.0,50.0,3000,250,30,50.0,20,5.0,30,7,80,20937,-2.8,716,332,65.0,87.9,3,4746,151
美国,2021,149,10.0,3600,50.0,60,10.0,3600,93,220.0,75.0,15.0,0.7,17,300,20.0,500,60.0,22,20.0,80.0,4000,350,50,80.0,20,10.0,50,7,82,23315,5.8,773,332,64.8,86.2,3,4825,367
美国,2022,150,20.0,4000,100.0,75,20.0,4000,94,240.0,80.0,16.0,0.75,18,320,25.0,550,70.0,24,30.0,120.0,5000,450,80,120.0,20,15.0,70,8,84,25439,1.9,706,333,64.6,86.3,2,4825,388
美国,2023,161,30.0,4500,150.0,85,30.0,4500,95,260.0,85.0,17.0,0.8,19,340,30.0,600,80.0,26,40.0,180.0,6000,550,120,180.0,20,20.0,100,9,86,27721,2.8,773,340,64.4,86.2,3,4825,311
美国,2024,172,35.0,5000,175.0,90,35.0,5000,95,280.0,90.0,18.0,0.82,20,360,35.0,650,90.0,28,67.8,250.0,6500,650,154,250.0,20,25.0,131,9,87,28751,2.8,910,342,64.3,87.9,3,4825,378
美国,2025,175,39.7,5427,200.0,95,39.7,5427,95,300.0,95.0,19.0,0.85,21,380,40.0,700,100.0,30,70.0,371.7,6956,793,200,371.7,20,30.0,150,9,87,30616,2.0,910,347,64.1,88.0,3,4825,388
中国,2016,167,0.1,300,1.0,0,0.1,300,53,80.0,20.0,5.0,4.7,20,100,10.0,100,5.0,18,10.0,5.0,200,20,2,5.0,150,2.0,2,6,50,11138,6.8,3011,1403,72.9,43.4,25,1225,134
中国,2017,202,0.15,320,1.5,0,0.15,320,54,90.0,25.0,6.0,4.8,25,120,15.0,150,10.0,23,20.0,7.5,300,40,5,7.5,150,3.0,5,6,52,12310,6.9,3236,1411,72.5,48.2,22,1307,168
中国,2018,229,0.2,350,2.0,0,0.2,350,57,100.0,30.0,7.0,4.9,30,140,20.0,200,16.0,28,30.0,10.0,500,60,10,10.0,150,5.0,10,7,55,13895,6.7,3168,1415,71.9,50.6,17,1471,155
中国,2019,219,0.3,380,3.0,5,0.3,380,61,120.0,35.0,8.0,5.0,35,160,25.0,250,15.0,33,50.0,15.0,700,80,20,15.0,150,10.0,15,7,58,14280,6.0,3202,1420,71.2,59.6,14,1585,187
中国,2020,212,0.5,400,5.0,60,0.5,400,70,140.0,40.0,10.0,5.1,40,180,30.0,300,12.0,38,70.0,25.0,900,100,50,25.0,150,15.0,20,8,60,14688,2.2,3357,1425,70.6,59.9,14,1686,149
中国,2021,188,1.0,420,10.0,70,1.0,420,73,160.0,45.0,12.0,5.2,45,200,40.0,350,10.0,43,100.0,40.0,1100,140,100,40.0,175,20.0,30,8,62,17882,8.5,3427,1426,70.0,63.6,12,1849,181
中国,2022,173,2.0,440,20.0,80,2.0,440,75,180.0,50.0,14.0,5.3,50,220,50.0,400,9.0,48,150.0,60.0,1300,180,200,60.0,175,30.0,40,9,64,17795,3.0,3308,1425,69.3,68.0,11,1849,180
中国,2023,134,3.0,449,30.0,85,3.0,449,77,200.0,55.0,16.0,5.4,55,240,60.0,450,8.0,53,200.0,90.0,1500,220,500,90.0,175,47.5,50,10,66,17795,5.2,3456,1419,68.7,76.2,12,1849,43
中国,2024,63,0.4,380,4.0,90,0.4,380,78,220.0,60.0,18.0,5.5,58,260,70.0,500,7.0,56,300.5,125.0,1600,260,112,125.0,175,47.5,60,10,68,18744,5.0,3682,1409,68.1,83.1,11,1849,9
中国,2025,47,0.4,381,300.0,95,0.4,381,79,240.0,65.0,20.0,5.6,60,280,80.0,550,6.0,58,320.0,115.0,1605,284,1509,115.0,175,50.0,70,10,70,19399,4.8,3499,1416,67.5,85.0,10,1849,9
英国,2016,12,0.02,300,0.2,0,0.02,300,94,20.0,10.0,2.0,0.15,5,50,1.0,20,1.0,6,1.0,1.0,100,5,1,1.0,130,0.5,1,4,65,2692,2.2,123,66,64.8,59.5,3,4280,255
英国,2017,15,0.03,350,0.3,0,0.03,350,95,22.0,11.0,2.2,0.16,6,55,1.2,25,1.5,7,1.2,1.5,150,10,2,1.5,130,0.7,2,4,67,2685,2.4,151,66,64.5,60.0,5,4364,104
英国,2018,18,0.04,400,0.4,0,0.04,400,95,24.0,12.0,2.4,0.17,7,60,1.5,30,2.0,8,1.5,2.0,200,15,3,2.0,130,1.0,3,5,70,2871,1.3,173,67,64.2,60.1,4,4449,65
英国,2019,21,0.05,450,0.5,5,0.05,450,95,26.0,13.0,2.6,0.18,8,65,2.0,35,2.5,9,2.0,3.0,300,20,4,3.0,130,1.2,5,5,72,2831,1.6,174,67,64.0,60.7,5,4535,67
英国,2020,24,0.1,470,1.0,20,0.1,470,96,28.0,14.0,2.8,0.19,9,70,2.5,40,3.0,10,2.5,5.0,400,25,5,5.0,130,1.5,7,6,74,2704,-10.4,185,67,63.7,61.5,4,4622,20
英国,2021,27,0.2,480,2.0,40,0.2,480,96,30.0,15.0,3.0,0.2,10,75,3.0,45,3.5,12,3.0,8.0,500,30,7,8.0,130,2.0,10,6,76,3141,8.7,194,67,63.5,62.0,4,4710,44
英国,2022,30,0.5,490,5.0,50,0.5,490,96,32.0,16.0,3.2,0.21,11,80,3.5,50,4.0,13,4.0,12.0,600,35,10,12.0,130,3.0,15,7,78,3070,4.3,175,67,63.3,77.4,4,4799,45
英国,2023,32,0.1,499,1.0,60,0.1,499,96,34.0,17.0,3.4,0.22,12,85,4.0,55,4.5,14,5.0,18.0,700,40,12,18.0,130,3.5,20,8,79,3381,0.3,178,68,63.1,77.3,4,4889,16
英国,2024,13,0.12,512,1.2,70,0.12,512,97,36.0,18.0,3.6,0.23,13,90,4.5,60,5.0,15,6.0,25.0,800,45,15,25.0,130,4.0,25,8,79,3583,1.1,180,69,62.9,83.3,6,4979,31
英国,2025,13,0.12,523,1.2,74,0.12,523,97,38.0,19.0,3.8,0.24,14,95,5.0,65,5.5,16,7.0,28.0,885,64,20,28.0,130,4.5,30,8,79,3959,1.3,185,68,62.7,84.0,6,5070,48
德国,2016,26,0.03,400,0.3,0,0.03,400,89,15.0,8.0,1.5,0.2,4,40,0.8,50,0.5,5,0.8,0.8,80,3,1,0.8,25,0.4,1,4,60,3479,2.2,189,82,65.7,68.3,10,4400,35
德国,2017,28,0.04,420,0.4,0,0.04,420,90,16.0,9.0,1.6,0.21,5,45,1.0,55,0.7,6,1.0,1.2,100,5,1,1.2,25,0.5,2,4,62,3701,2.7,200,83,65.3,68.3,9,4512,82
德国,2018,31,0.05,440,0.5,0,0.05,440,91,18.0,10.0,1.8,0.22,6,50,1.2,60,1.0,7,1.2,1.6,150,8,2,1.6,25,1.0,3,5,65,3979,1.0,197,83,65.0,70.3,9,4626,160
德国,2019,33,0.06,460,0.6,5,0.06,460,92,20.0,11.0,2.0,0.23,7,55,1.5,65,1.2,8,1.5,2.4,200,10,3,2.4,25,1.5,5,5,68,3888,1.1,224,83,64.7,71.3,9,4742,67
德国,2020,36,0.1,470,1.0,15,0.1,470,92,22.0,12.0,2.2,0.24,8,60,2.0,70,1.5,9,2.0,4.0,250,13,4,4.0,25,2.0,7,6,70,3888,-4.1,295,83,64.4,72.2,9,4859,39
德国,2021,38,0.2,480,2.0,30,0.2,480,93,24.0,13.0,2.4,0.25,9,65,2.5,75,1.8,10,2.5,6.4,300,15,5,6.4,25,2.5,10,6,72,4320,3.2,295,83,64.2,73.3,10,4978,31
德国,2022,40,0.3,490,3.0,40,0.3,490,93,26.0,14.0,2.6,0.26,10,70,3.0,80,2.0,11,3.0,9.6,350,18,7,9.6,25,3.0,13,7,74,4082,1.8,295,84,64.1,74.0,8,5098,10
德国,2023,41,0.04,487,0.4,50,0.04,487,93,28.0,15.0,2.8,0.27,11,75,3.5,85,2.2,12,4.0,14.4,400,20,10,14.4,25,3.5,15,8,76,4526,-0.2,295,84,64.0,74.5,8,5219,16
德国,2024,41,0.05,522,0.5,60,0.05,522,94,30.0,16.0,3.0,0.28,12,80,4.0,90,2.5,13,5.0,20.0,450,23,12,20.0,25,4.0,18,8,77,4686,-0.5,378,84,63.9,74.5,10,5341,37
德国,2025,41,0.05,529,0.5,65,0.05,529,94,32.0,17.0,3.2,0.29,13,85,4.5,95,2.8,14,6.0,22.0,394,40,15,22.0,25,4.5,20,8,77,5014,0.2,377,84,63.8,75.0,11,5464,16
韩国,2016,4,0.01,30,0.1,0,0.01,30,92,10.0,5.0,1.0,0.1,3,30,0.5,30,0.3,3,1.0,0.5,50,2,0,0.5,30,0.2,1,3,55,1500,2.9,371,51,73.1,94.3,11,7129,12
韩国,2017,5,0.02,35,0.2,0,0.02,35,93,11.0,6.0,1.1,0.11,4,35,0.7,35,0.4,4,1.2,0.7,70,3,1,0.7,30,0.3,2,3,57,1624,3.1,389,51,73.0,94.3,11,7498,13
韩国,2018,6,0.03,40,0.3,0,0.03,40,96,12.0,7.0,1.2,0.12,5,40,1.0,40,0.6,5,1.5,1.0,100,5,1,1.0,30,0.5,3,4,60,1725,2.9,404,52,72.8,94.5,12,7899,12
韩国,2019,7,0.04,43,0.4,85,0.04,43,96,13.0,8.0,1.3,0.13,6,45,1.2,45,0.8,6,2.0,1.5,150,7,2,1.5,30,0.7,5,4,63,1652,2.2,409,52,72.7,95.9,11,8319,9
韩国,2020,8,0.1,45,1.0,90,0.1,45,97,15.0,9.0,1.5,0.14,7,50,1.5,50,1.0,7,3.0,2.5,200,9,3,2.5,30,1.0,7,5,65,1645,-0.7,443,52,72.3,103.9,10,8653,8
韩国,2021,9,0.5,48,5.0,95,0.5,48,97,18.0,10.0,1.8,0.15,8,55,2.0,55,1.2,9,4.0,4.0,250,11,5,4.0,30,1.5,10,5,70,1811,4.3,463,52,71.9,96.7,5,9000,16
韩国,2022,10,1.0,50,10.0,95,1.0,50,97,20.0,12.0,2.0,0.16,9,60,2.5,60,1.5,10,5.0,6.0,300,13,7,6.0,30,2.0,13,6,75,1673,2.6,424,52,71.4,98.4,6,9000,18
韩国,2023,13,3.0,43,30.0,95,3.0,43,97,22.0,14.0,2.2,0.17,10,65,3.0,65,1.8,11,7.0,9.0,350,15,10,9.0,30,3.0,15,7,78,1712,1.4,416,52,70.9,98.4,10,9000,25
韩国,2024,13,4.0,40,40.0,95,4.0,40,97,24.0,16.0,2.4,0.18,11,70,3.5,70,2.0,12,23.7,12.5,400,18,13,12.5,30,3.5,18,7,80,1728,1.6,416,52,70.3,103.3,6,9000,18
韩国,2025,15,5.1,43,51.0,95,5.1,43,97,26.0,18.0,2.6,0.19,12,75,4.0,75,2.2,13,25.0,13.0,270,21,15,13.0,30,4.0,20,7,80,1937,1.8,416,52,69.7,103.3,4,9000,21
日本,2016,37,0.02,180,0.2,0,0.02,180,91,12.0,6.0,1.2,0.3,4,35,0.6,80,0.2,4,2.0,0.6,60,1,1,0.6,12,0.3,1,3,60,5004,0.5,1217,127,60.3,64.0,16,5241,6
日本,2017,36,0.03,190,0.3,0,0.03,190,92,13.0,7.0,1.3,0.31,5,40,0.8,85,0.3,5,2.5,0.9,80,2,1,0.9,12,0.4,2,3,62,4930,1.7,1264,127,59.7,64.1,14,5241,9
日本,2018,35,0.04,200,0.4,0,0.04,200,93,14.0,8.0,1.4,0.32,6,45,1.0,90,0.5,6,3.0,1.2,100,3,2,1.2,12,0.5,3,4,65,5041,0.6,1271,126,59.4,63.9,13,5304,10
日本,2019,29,0.05,210,0.5,5,0.05,210,93,15.0,9.0,1.5,0.33,7,50,1.2,95,0.7,7,4.0,1.8,150,5,3,1.8,12,0.7,5,4,68,5117,-0.4,1324,126,59.0,64.1,15,5367,14
日本,2020,32,0.1,220,1.0,20,0.1,220,94,17.0,10.0,1.7,0.34,8,55,1.5,100,0.8,8,5.0,3.0,200,7,4,3.0,12,1.0,7,5,70,5041,-4.3,1378,126,58.8,64.9,16,5431,13
日本,2021,33,0.2,230,2.0,40,0.2,230,94,19.0,11.0,1.9,0.35,9,60,2.0,105,1.0,10,6.0,4.8,250,9,5,4.8,12,1.5,10,5,72,5041,2.2,1406,125,58.6,64.4,13,5495,24
日本,2022,34,0.5,235,5.0,50,0.5,235,95,21.0,12.0,2.1,0.36,10,65,2.5,110,1.2,11,8.0,7.2,300,11,7,7.2,12,2.0,13,6,74,4256,1.0,1227,125,58.4,65.0,13,5560,33
日本,2023,35,1.0,242,10.0,60,1.0,242,95,23.0,13.0,2.3,0.37,11,70,3.0,115,1.5,12,10.0,10.8,350,13,10,10.8,12,3.0,15,7,76,4204,1.7,1231,124,58.3,65.4,13,5625,20
日本,2024,34,1.2,240,12.0,70,1.2,240,95,25.0,14.0,2.5,0.38,12,75,3.5,120,1.8,13,26.4,15.0,400,15,12,15.0,12,3.5,18,7,77,4028,0.1,1253,123,58.1,65.5,12,5690,11
日本,2025,43,1.4,242,14.0,75,1.4,242,95,27.0,15.0,2.7,0.39,13,80,4.0,125,2.0,14,28.0,16.0,388,16,15,16.0,12,4.0,20,7,78,4280,1.1,1253,122,57.9,65.5,12,5756,18
法国,2016,18,0.01,150,0.1,0,0.01,150,80,10.0,4.0,1.0,0.18,3,30,0.4,25,0.4,4,0.5,0.4,50,2,1,0.4,30,0.2,1,3,60,2472,1.1,146,65,62.3,64.6,18,4212,28
法国,2017,19,0.02,160,0.2,0,0.02,160,81,11.0,5.0,1.1,0.19,4,35,0.5,30,0.5,5,0.7,0.6,70,3,1,0.6,30,0.3,2,3,62,2595,2.3,156,65,62.0,65.3,15,4300,49
法国,2018,22,0.03,170,0.3,0,0.03,170,82,12.0,6.0,1.2,0.2,5,40,0.7,35,0.7,6,1.0,0.8,100,5,2,0.8,30,1.5,3,4,65,2787,1.9,162,65,61.7,65.6,16,4389,39
法国,2019,24,0.04,180,0.4,5,0.04,180,83,13.0,7.0,1.3,0.21,6,45,1.0,40,1.0,7,1.2,1.2,150,7,3,1.2,30,1.5,5,4,68,2716,1.9,181,65,61.4,66.0,16,4479,32
法国,2020,26,0.1,200,1.0,10,0.1,200,84,15.0,8.0,1.5,0.22,7,50,1.5,45,1.2,8,1.5,2.0,200,10,4,2.0,30,1.5,7,5,70,2647,-7.5,217,65,61.1,66.8,12,4570,-13
法国,2021,28,0.5,220,5.0,30,0.5,220,85,17.0,9.0,1.7,0.23,8,55,2.0,50,1.5,9,2.0,3.2,250,12,5,3.2,30,1.5,10,5,72,2959,6.4,238,65,60.8,67.8,11,4662,88
法国,2022,30,1.0,250,10.0,40,1.0,250,86,19.0,10.0,1.9,0.24,9,60,3.0,55,1.8,10,3.0,4.8,300,15,7,4.8,30,1.5,13,6,74,2779,2.5,221,65,60.6,68.3,11,4755,105
法国,2023,31,1.5,321,15.0,50,1.5,321,95,21.0,11.0,2.1,0.25,10,65,5.0,60,2.0,11,4.0,7.2,350,18,10,7.2,30,117.0,15,10,78,3032,0.9,222,65,60.4,68.7,11,4849,29
法国,2024,24,2.0,320,20.0,60,2.0,320,95,23.0,12.0,2.3,0.26,11,70,10.0,65,2.2,12,5.0,10.0,400,20,18,10.0,30,117.0,18,10,79,3140,1.1,363,65,60.2,69.0,11,4944,9
法国,2025,23,2.4,322,24.0,65,2.4,322,95,25.0,13.0,2.5,0.27,12,75,10.9,70,2.5,13,6.0,11.0,468,30,20,11.0,30,117.0,20,10,79,3362,0.7,363,65,60.0,69.5,11,5040,42
加拿大,2016,9,0.01,200,0.1,0,0.01,200,91,15.0,12.0,1.5,0.08,4,40,0.5,15,0.5,5,0.4,0.3,70,3,1,0.3,35,0.1,1,3,65,1527,1.0,83,36,68.0,67.1,15,4516,35
加拿大,2017,10,0.01,210,0.1,0,0.01,210,92,16.0,13.0,1.6,0.09,5,45,0.7,18,0.7,6,0.5,0.5,90,5,2,0.5,35,0.2,2,3,67,1649,3.0,87,36,67.6,68.9,18,4516,24
加拿大,2018,12,0.02,220,0.2,0,0.02,220,93,17.0,14.0,1.7,0.1,6,50,1.0,20,1.0,7,0.7,0.7,120,7,2,0.7,35,0.3,3,4,70,1725,2.8,84,37,67.2,69.0,18,4516,47
加拿大,2019,13,0.03,230,0.3,5,0.03,230,93,18.0,15.0,1.8,0.11,7,55,1.2,22,1.2,8,1.0,1.0,150,10,3,1.0,35,0.4,5,4,72,1743,1.9,85,38,66.8,70.1,17,4516,46
加拿大,2020,14,0.05,240,0.5,20,0.05,240,94,20.0,16.0,2.0,0.12,8,60,1.5,25,1.5,9,1.2,1.5,200,12,4,1.5,35,0.5,7,5,74,1645,-5.1,90,38,66.5,73.0,17,4516,24
加拿大,2021,15,0.1,250,1.0,40,0.1,250,94,22.0,17.0,2.2,0.13,9,65,2.0,30,1.8,10,1.5,2.4,250,15,5,2.4,35,1.0,10,5,76,2002,5.0,107,38,66.1,76.0,16,5412,60
加拿大,2022,16,0.2,260,2.0,50,0.2,260,95,24.0,18.0,2.4,0.14,10,70,2.4,35,2.0,11,2.0,3.6,300,18,6,3.6,35,1.5,12,6,78,2137,3.8,107,39,65.8,75.7,15,5412,54
加拿大,2023,17,0.3,293,3.0,60,0.3,293,94,26.0,19.0,2.6,0.15,11,75,2.4,40,2.2,12,3.0,5.4,350,20,7,5.4,35,2.4,15,8,80,2142,1.2,118,40,65.5,75.7,15,5412,50
加拿大,2024,13,0.5,320,5.0,70,0.5,320,94,28.0,20.0,2.8,0.16,12,80,2.4,45,2.5,13,4.0,7.5,400,23,7,7.5,35,2.4,18,8,81,2178,1.6,128,40,65.2,75.7,17,5412,46
加拿大,2025,19,0.5,337,5.0,75,0.5,337,94,30.0,22.0,3.0,0.17,13,85,2.4,50,2.8,14,5.0,8.0,481,30,10,8.0,35,2.4,20,8,81,2242,1.2,128,40,64.9,76.0,17,5412,46
阿联酋,2016,1,0.01,10,0.1,0,0.01,10,91,1.0,1.0,0.1,0.01,1,5,0.1,2,0.1,1,0.1,0.1,10,1,0,0.1,0,0.1,0,2,40,375,3.1,85,9,85.1,36.8,41,2000,9
阿联酋,2017,2,0.01,15,0.1,0,0.01,15,95,1.5,1.5,0.2,0.01,1,7,0.2,3,0.2,1,0.2,0.2,20,2,0,0.2,0,0.2,1,2,42,390,2.0,95,9,84.8,36.3,35,2100,10
阿联酋,2018,3,0.01,20,0.1,0,0.01,20,98,2.0,2.0,0.3,0.02,1,10,0.5,5,0.5,1,0.3,0.3,50,3,1,0.3,0,0.5,2,3,45,427,1.3,99,10,84.4,49.3,38,2200,10
阿联酋,2019,4,0.02,25,0.2,10,0.02,25,98,3.0,3.0,0.4,0.02,2,15,1.0,7,1.0,2,0.5,0.5,100,5,1,0.5,0,1.0,3,3,50,417,1.7,108,10,84.0,50.0,36,2300,14
阿联酋,2020,5,0.05,30,0.5,50,0.05,30,99,4.0,4.0,0.5,0.03,2,20,2.0,10,2.0,2,1.0,1.0,200,7,2,1.0,0,2.0,5,4,55,349,-6.1,107,10,83.6,49.2,34,2400,20
阿联酋,2021,6,1.0,40,10.0,80,1.0,40,99,6.0,6.0,0.7,0.04,3,25,5.0,15,3.0,3,2.0,2.0,300,10,3,2.0,0,5.0,7,5,60,415,4.4,138,10,83.1,49.5,33,2500,21
阿联酋,2022,7,5.0,50,50.0,90,5.0,50,99,8.0,8.0,1.0,0.05,4,30,10.0,20,5.0,4,3.0,3.0,400,12,4,3.0,0,10.0,10,6,65,507,7.9,139,10,82.7,49.8,31,2600,23
阿联酋,2023,8,10.0,30,100.0,95,10.0,30,99,10.0,10.0,1.2,0.06,5,35,15.0,25,7.0,5,5.0,5.0,500,15,5,5.0,0,100.0,12,10,70,504,3.4,434,9,82.2,50.0,32,2700,28
阿联酋,2024,4,20.0,35,200.0,99,20.0,35,100,12.0,12.0,1.5,0.07,6,40,20.0,30,10.0,6,7.0,7.0,600,18,7,7.0,0,100.0,15,10,75,552,4.2,552,9,81.7,49.5,18,2800,28
阿联酋,2025,4,23.1,40,231.0,99,23.1,40,100,15.0,15.0,2.0,0.08,7,45,25.0,35,12.0,7,8.0,8.0,600,20,10,8.0,0,100.0,18,10,80,574,4.8,620,9,81.2,50.0,18,2900,28
印度,2016,9,0.01,80,0.1,0,0.01,80,29,30.0,-20.0,2.0,2.6,4,50,0.2,10,0.3,4,0.5,0.2,50,5,0,0.2,100,0.1,0,2,40,2295,8.3,360,1324,65.5,27.5,66,216,44
印度,2017,11,0.01,90,0.1,0,0.01,90,34,35.0,-22.0,2.5,2.7,5,60,0.3,12,0.5,5,0.7,0.3,70,10,1,0.3,100,0.1,1,2,42,2651,6.8,413,1339,65.8,27.8,60,216,40
印度,2018,13,0.01,100,0.1,0,0.01,100,35,40.0,-25.0,3.0,2.8,6,70,0.5,15,0.7,6,1.0,0.5,100,15,1,0.5,100,0.2,2,3,45,2703,6.5,399,1354,66.1,28.1,57,253,42
印度,2019,15,0.02,110,0.2,0,0.02,110,41,45.0,-28.0,3.5,2.9,8,80,0.7,18,1.0,8,1.5,0.8,150,20,2,0.8,100,0.3,3,3,48,2831,3.7,464,1369,66.4,28.0,52,253,50
印度,2020,17,0.05,120,0.5,0,0.05,120,45,50.0,-30.0,4.0,3.0,10,90,1.0,20,1.2,10,2.0,1.2,200,25,3,1.2,100,0.5,5,3,50,2667,-5.8,590,1383,66.7,28.4,48,253,64
印度,2021,18,0.2,130,2.0,5,0.2,130,46,60.0,-25.0,5.0,3.1,12,100,1.5,25,1.5,12,3.0,2.0,250,30,5,2.0,100,1.0,7,4,52,3150,9.7,634,1393,67.0,31.3,46,253,45
印度,2022,20,0.5,140,5.0,10,0.5,140,48,70.0,-20.0,6.0,3.2,15,110,2.0,30,2.0,15,5.0,3.0,300,40,7,3.0,100,1.2,10,5,55,3386,7.0,563,1417,67.3,32.0,40,253,49
印度,2023,22,0.8,271,8.0,30,0.8,271,56,80.0,-15.0,7.0,3.3,17,120,2.5,35,2.5,17,7.0,5.0,350,50,10,5.0,100,1.25,12,6,60,3568,8.2,643,1429,67.5,32.5,40,253,28
印度,2024,6,1.0,200,10.0,50,1.0,200,60,90.0,-10.0,8.0,3.4,18,130,3.0,40,3.0,18,26.0,7.0,400,60,12,7.0,100,1.25,15,6,65,3937,7.0,686,1441,67.8,32.5,39,253,53
印度,2025,6,1.2,271,12.0,60,1.2,271,65,100.0,-5.0,9.0,3.5,20,140,1.25,45,3.5,20,28.0,11.0,434,88,15,11.0,100,1.25,18,6,70,4125,6.6,780,1464,68.1,33.0,38,253,62
"""

class DataLoader:
    def __init__(self):
        self.translation_map = {
            'Top500超级计算机数量': 'Supercomputers',
            'GPU集群规模_百万个': 'GPU_Scale',
            '数据中心总算力': 'Compute_Power',
            'AI芯片保有量_百万个': 'AI_Chips',
            '5G覆盖率': '5G_Coverage',
            '互联网带宽': 'Bandwidth',
            '数据中心数量': 'Data_Centers',
            '互联网普及率': 'Internet_Penetration',
            'AI研究人员数量_千人': 'AI_Researchers',
            'AI人才净流入_千人': 'Talent_Inflow',
            '顶尖AI学者数量_千人': 'Top_Scholars',
            'STEM毕业生数量_百万': 'STEM_Grads',
            'AI论文数量_千篇': 'AI_Papers',
            '高校AI实验室数量': 'AI_Labs',
            '政府AI投资_亿美元': 'Gov_Investment',
            '企业AI研发支出_亿美元': 'Corp_RD',
            '风险投资_亿美元': 'VC_Investment',
            'AI论文引用量_千次': 'Paper_Citations',
            'AI专利申请数量_千件': 'AI_Patents',
            'AI市场规模_亿美元': 'AI_Market_Size',
            'AI企业数量': 'AI_Companies',
            'AI独角兽企业数量': 'Unicorn_Companies',
            '大模型数量': 'LLM_Count',
            '产业市场规模_亿美元': 'Ind_Market_Size',
            'AI企业税收减免比例': 'Tax_Breaks',
            '补贴金额_亿美元': 'Subsidies',
            '政策数量': 'Policy_Count',
            '补贴力度': 'Subsidy_Intensity',
            '监管框架完善程度': 'Regulation_Score',
            'GDP_亿美元': 'GDP',
            'GDP增长率': 'GDP_Growth',
            '外汇储备_十亿美元': 'Forex_Reserves',
            '人口_百万': 'Population',
            '劳动年龄人口比例': 'Labor_Force_Rate',
            '高等教育毛入学率': 'Edu_Enrollment',
            '全球创新指数排名': 'Innovation_Rank',
            '研发人员密度_每百万人': 'RD_Density',
            'FDI流入_十亿美元': 'FDI_Inflow'
        }
        
        self.country_map = {
            '中国': 'China',
            '美国': 'USA',
            '英国': 'UK',
            '德国': 'Germany',
            '韩国': 'South Korea',
            '日本': 'Japan',
            '法国': 'France',
            '加拿大': 'Canada',
            '阿联酋': 'UAE',
            '印度': 'India'
        }

    def load_data(self):
        # Read from string
        df = pd.read_csv(StringIO(RAW_CSV_DATA))
        
        # Translate columns
        df.rename(columns=self.translation_map, inplace=True)
        
        # Translate Countries
        df['Country'] = df['Country'].map(self.country_map)
        
        # Interpolate missing values (grouped by Country)
        df = df.groupby('Country', group_keys=False).apply(
            lambda group: group.interpolate(method='linear', limit_direction='both')
        )
        
        # Save Raw Processed
        df.to_csv(os.path.join(RESULTS_DIR, "processed_data.csv"), index=False)
        return df

    def get_normalized_data(self, df):
        scaler = MinMaxScaler()
        numeric_cols = df.select_dtypes(include=[np.number]).columns
        cols_to_norm = [c for c in numeric_cols if c != 'Year']
        
        df_norm = df.copy()
        df_norm[cols_to_norm] = scaler.fit_transform(df[cols_to_norm])
        return df_norm